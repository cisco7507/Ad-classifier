# =============================================================================
# Video Ad Classifier — Environment Configuration
# Copy this file to .env and edit values before running.
# =============================================================================

# ── Node identity ─────────────────────────────────────────────────────────────
# Unique name for this node (used as job ID prefix).
NODE_NAME=node-a

# Port the Uvicorn API server listens on.
PORT=8000

# ── Database ──────────────────────────────────────────────────────────────────
# SQLite database file path. Each node in a cluster must point to its OWN file.
# Single-node: use the default.
DATABASE_PATH=video_service.db

# ── Cluster config ────────────────────────────────────────────────────────────
# Path to the JSON file defining cluster nodes (see cluster_config.json).
# Leave unset for single-node mode — the node registers itself automatically.
# CLUSTER_CONFIG=cluster_config.json

# ── Storage paths ─────────────────────────────────────────────────────────────
# Temporary directory for uploaded video files.
UPLOAD_DIR=/tmp/video_service_uploads

# Persistent directory for per-job artifacts (extracted frames, etc.)
ARTIFACTS_DIR=/tmp/video_service_artifacts

# ── Security ──────────────────────────────────────────────────────────────────
# Maximum upload size in MB (default: 500).
MAX_UPLOAD_MB=500

# Maximum URL-fetched content size in MB (default: 2048).
URL_MAX_SIZE_MB=2048

# HTTP timeout in seconds when fetching a video URL (default: 30).
URL_FETCH_TIMEOUT=30

# Optional comma-separated hostname allowlist. If set, only these hosts are
# allowed in /jobs/by-urls submissions. Empty = allow all.
# URL_HOST_ALLOWLIST=mycompany.com,cdn.mycompany.com

# Optional comma-separated hostname denylist. These hosts are always rejected.
# URL_HOST_DENYLIST=localhost,127.0.0.1,169.254.0.0/16

# Comma-separated absolute paths that the /jobs/by-folder endpoint may scan.
# If empty, any absolute server-side path is accepted (less secure).
# ALLOWED_FOLDER_ROOTS=/data/videos,/mnt/nas/ads

# ── CORS ──────────────────────────────────────────────────────────────────────
# Comma-separated list of allowed origins for the dashboard.
# Adjust to your dashboard URL in production.
CORS_ORIGINS=http://localhost:5173,http://localhost:5174,http://127.0.0.1:5173,http://127.0.0.1:5174

# ── Cleanup ───────────────────────────────────────────────────────────────────
# Enable/disable background cleanup thread (true/false).
CLEANUP_ENABLED=true

# Delete completed/failed job rows older than this many days.
JOB_TTL_DAYS=30

# How often the cleanup job runs (hours).
CLEANUP_INTERVAL_HOURS=6

# ── Workers ───────────────────────────────────────────────────────────────────
# Number of concurrent pipeline workers per job (passed to run_pipeline_job).
# 1 is recommended on MPS/CPU to avoid OOM; increase with caution on GPU.
DEFAULT_WORKERS=1

# ── Logging ───────────────────────────────────────────────────────────────────
# Python log level (DEBUG, INFO, WARNING, ERROR).
LOG_LEVEL=INFO

# ── Device / ML ───────────────────────────────────────────────────────────────
# Torch device override. Leave empty for auto-detect (MPS > CUDA > CPU).
# TORCH_DEVICE=cpu
